<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Sistema di Prenotazioni Campi da Tennis Capaci</title>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js"></script>
    <style>
        #calendar {
            max-width: 900px;
            margin: 40px auto;
        }
        #bookingForm {
            max-width: 900px;
            margin: 20px auto;
        }
    </style>
</head>
<body>
    <h1>Sistema di Prenotazioni Campi da Tennis</h1>

    <!-- Selezione campo e titolo dinamico -->
    <label for="courtSelect">Campo:</label>
    <select id="courtSelect">
        <option value="Campo 1">Campo 1</option>
        <option value="Campo 2">Campo 2</option>
    </select>
    <h2 id="calendarTitle">Campo 1: Aug 17 – 23, 2025</h2>

    <div id="calendar"></div>

    <!-- Form per inserimento dati giocatore -->
    <div id="bookingForm">
        <h3>Nuova Prenotazione</h3>
        <label>Nome Giocatore: <input type="text" id="playerName"></label><br>
        <label>Durata: 
            <select id="durationSelect">
                <option value="60">60 minuti</option>
                <option value="90">90 minuti</option>
                <option value="120">120 minuti</option>
            </select>
        </label><br>
        <button id="bookButton">Prenota</button>
    </div>

    <script>
        let calendarEl = document.getElementById('calendar');
        let selectedCourt = document.getElementById("courtSelect").value;
        let selectedEvent = null;
        let currentWeekRange = 'Aug 17 – 23, 2025'; // Puoi calcolare dinamicamente con FullCalendar se vuoi

        let calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'timeGridWeek',
            selectable: true,
            events: [], // inizialmente vuoto
            select: function(info) {
                // Reset precedente selezione
                if(selectedEvent) selectedEvent.remove();

                let playerName = document.getElementById("playerName").value;
                let duration = parseInt(document.getElementById("durationSelect").value);

                let endTime = new Date(info.start);
                endTime.setMinutes(endTime.getMinutes() + duration);

                selectedEvent = calendar.addEvent({
                    title: playerName ? playerName : 'Prenotazione',
                    start: info.start,
                    end: endTime,
                    backgroundColor: '#ff9f89'
                });
            }
        });

        calendar.render();

        // Aggiorna titolo e reset selezione quando cambio campo
        document.getElementById("courtSelect").addEventListener("change", function() {
            selectedCourt = this.value;
            document.getElementById("calendarTitle").innerText = selectedCourt + ": " + currentWeekRange;

            if(selectedEvent) {
                selectedEvent.remove();
                selectedEvent = null;
            }
        });

        // Pulsante "Prenota" finale (puoi collegarlo a Flask)
        document.getElementById("bookButton").addEventListener("click", function() {
            if(selectedEvent) {
                alert("Prenotazione confermata per " + selectedEvent.title + " su " + selectedCourt);
                selectedEvent = null; // reset selezione dopo conferma
            } else {
                alert("Seleziona un orario prima di prenotare!");
            }
        });
    </script>
</body>
</html>
